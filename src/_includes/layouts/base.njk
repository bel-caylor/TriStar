<!DOCTYPE html>
<html lang="en" class="bg-white text-zinc-900 dark:bg-zinc-900 dark:text-white">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ title }}</title>
  <link href="/style.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    crossorigin="anonymous" />
</head>

<body class="min-h-screen flex flex-col">
  <div x-data="mainApp()" x-init="init()" class="flex flex-col flex-1">
    {% include "components/header.njk" %}

    <div class="flex flex-1 overflow-hidden">
      <!-- Sidebar -->
      <aside x-show="sidebarOpen && loggedIn && Object.keys(currentUser).length > 0"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 transform -translate-x-4"
        x-transition:enter-end="opacity-100 transform translate-x-0"
        x-transition:leave="transition ease-in duration-150"
        x-transition:leave-start="opacity-100 transform translate-x-0"
        x-transition:leave-end="opacity-0 transform -translate-x-4"
        @click.outside="if (mobileScreen) sidebarOpen = false" 
        class="right-side">

        {% include "components/sidebar-nav.njk" %}

      </aside>

      <!-- Main Content -->
      <main :class="{ 'ml-20': sidebarOpen }"
        class="transition-all duration-300 ease-in-out">
        {{ content | safe }}
        {% include "components/footer.njk" %}
      </main>
    </div>
  </div>


  <script src="/js/main.js"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

</body>

<script>
  function mainApp() {
    return {
      sidebarOpen: window.innerWidth >= 768,
      mobileScreen: window.innerWidth < 768,
      currentUser: {
        firstName: 'Sally',
        lastName: 'Sample',
        employer: 'MNE LLC (#00903)'
      },
      // currentUser: {},
      loggedIn: true,
      admin: false,

      init() {
        const updateScreen = () => {
          this.mobileScreen = window.innerWidth < 768;
          this.sidebarOpen = window.innerWidth >= 768;
        };
        window.addEventListener('resize', updateScreen);
        updateScreen();
      },
    }
  }

</script>

</html>