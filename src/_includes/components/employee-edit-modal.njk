{% from "components/banner-notice.njk" import bannerNotice %}
{% from "components/input-field.njk" import
   textInputField,
   dateInputField,
   selectField,
   radioGroup
%}


<div
  x-show="showModal"
  x-cloak
  class="fixed inset-0 z-50 flex items-start justify-center pt-10 bg-black bg-opacity-50 overflow-y-auto"
  @keydown.escape.window="closeModal()"
  @click.away="closeModal()"
>
  <!-- Modal Card -->
  <div class="bg-white rounded-lg shadow-lg w-full max-w-2xl mx-4" @click.stop>
    <!-- Header -->
    <div class="flex justify-between items-center px-6 py-4 border-b border-gray-200">
      <div class="flex items-center">
        <i class="fas fa-user text-2xl text-gray-700 mr-3"></i>
        <h2 class="text-xl font-semibold text-gray-800 mb-0">Edit Personal Information</h2>
      </div>
      {% include "components/button-close.njk" %}
    </div>

    <!-- Body / Form -->
    <div class="px-6 py-6 space-y-6">
      {{ bannerNotice('
        <p class="text-yellow-700 text-sm">
          You know the drill, <span class="text-red-500">*</span> means Required.
        </p>
        <p class="mt-1 text-yellow-800 text-sm">
          Please review the information below. Please ask your HR to make any
          changes in the Chick-fil-A Payroll System.
        </p>
      ') }}


      <form @submit.prevent="updateEmployee()" class="space-y-6">
        {# ────── Row 1: First Name, MI, Last Name, Suffix ────── #}
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          {{ textInputField("First Name",      "firstName",      "selectedEmployee.firstName",    "First name",    "text", true) }}
          {{ textInputField("MI",              "middleInitial",  "selectedEmployee.middleInitial", "Middle N.",     "text", false) }}
          {{ textInputField("Last Name",       "lastName",       "selectedEmployee.lastName",     "Last name",     "text", true) }}
          {{ textInputField("Suffix",          "suffix",         "selectedEmployee.suffix",        "Suffix",        "text", false) }}
        </div>

        {# ────── Row 2: Birth Date & Gender ────── #}
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
          {{ dateInputField("Birth Date", "birthDate", "selectedEmployee.birthDate", true) }}

          <div class="md:col-span-2">
            {{ radioGroup(
                "Gender",
                "gender",
                "selectedEmployee.gender",
                [
                  { value: "Male",   label: "Male" },
                  { value: "Female", label: "Female" },
                  { value: "Unknown", label: "Unknown" }
                ]
              )
            }}
          </div>
        </div>

        {# ────── Row 3: Address 1 & Address 2 ────── #}
        <div class="grid grid-cols-1 gap-4">
          {{ textInputField("Address 1", "address1", "selectedEmployee.address1", "", "text", true) }}
          {{ textInputField("Address 2", "address2", "selectedEmployee.address2", "", "text", false) }}
        </div>

        {# ────── Row 4: City, State, Zip Code ────── #}
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          {{ textInputField("City",    "city",    "selectedEmployee.city",    "",        "text", true) }}

          {# Use selectField for state dropdown #}
          {{ selectField(
              "State",
              "state",
              "selectedEmployee.state",
              states,
              true
            )
          }}

          {{ textInputField("Zip Code", "zip",      "selectedEmployee.zipCode", "",       "text", true) }}
        </div>

        {# ────── Row 5: Phone Number ────── #}
        <div class="grid grid-cols-1 gap-4">
          <div>
            <span class="block text-sm font-medium text-gray-700">Phone Number</span>
            <div class="mt-1 flex space-x-2">
              {{ textInputField("", "phoneArea",  "selectedEmployee.phoneArea",  "area",  "text", false) }}
              {{ textInputField("", "phoneLocal", "selectedEmployee.phoneLocal", "local", "text", false) }}
              {{ textInputField("", "phoneNumber","selectedEmployee.phoneNumber","number","text", false) }}
            </div>
          </div>
        </div>

        {# ────── Row 6: Email ────── #}
        <div class="grid grid-cols-1 gap-4">
          {{ textInputField(
              "Email (<span class=\"text-gray-500\">not required</span>), but it would really help us",
              "email",
              "selectedEmployee.email",
              "",
              "email",
              false
            ) }}
        </div>

        {# ────── Buttons ────── #}
        <div class="pt-4 flex justify-end space-x-3">
          <button
            type="button"
            class="px-4 py-2 bg-red-500 text-white text-sm font-medium rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400"
            @click="closeModal()"
          >
            Cancel
          </button>

          <button
            type="submit"
            class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          >
            Update
          </button>
        </div>
      </form>

    </div>
  </div>
</div>
